<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="page" content="bulk">
  <title>ImmunoStream — Bulk amplicon</title>

  <!-- Shared header styles & behavior -->
  <link rel="stylesheet" href="assets/css/nav.css">
  <script src="assets/js/nav.js" defer></script>

  <!-- Bulk page styles -->
  <link rel="stylesheet" href="assets/css/bulk.css">
  <script type="module" src="assets/js/bulk.js"></script>
</head>
<body>
  <div class="wrap">
    <main class="left">
      <div class="panel">
        <h1>Immun Stream</h1>

        <h2>1) Start / Upload</h2>
        <div class="grid">
          <div class="card">
            <h3>Upload reads</h3>
            <label>R1 FASTQ(.gz)</label><input type="file" id="r1f" />
            <label>R2 FASTQ(.gz) (optional)</label><input type="file" id="r2f" />
            <div class="mt8"><button id="upload">Upload</button></div>
          </div>

          <div class="card">
            <h3>Upload aux (primers/reference)</h3>
            <label>Choose file</label><input type="file" id="auxf" />
            <label>Store as (optional)</label><input id="auxname" placeholder="e.g. V.fasta or C.fasta" />
            <div class="mt8 row">
              <button id="upload-aux">Upload aux</button>
              <span id="aux-out" class="muted"></span>
            </div>
            <div class="muted mt8">Primer FASTA uploads are auto-recognized and wired into MaskPrimers (V/C).</div>
          </div>
        </div>

        <h2>2) Units</h2>
        <div id="units" class="grid"></div>

        <h2>3) Pipeline</h2>
        <div class="row mb8">
          <button id="pipe-validate" class="secondary">Validate</button>
          <button id="pipe-run">Run pipeline</button>
          <button id="pipe-clear" class="secondary">Clear</button>
          <span id="pipe-msg" class="muted"></span>
        </div>

        <h2>State</h2>
        <div id="state" class="mb8"></div>

        <h2>Last step log</h2>
        <pre id="log" class="mb8"></pre>

        <h2>Artifacts</h2>
        <div id="arts"></div>
      </div>
    </main>

    <aside class="right">
      <div class="panel">
        <h2>Pipeline overview</h2>
        <div class="muted">Checked units appear here in click order.</div>

        <h3 class="mt8">Flow</h3>
        <div id="flow" class="flow"></div>

        <h3 class="mt8">Validation</h3>
        <div id="validation" class="muted">—</div>

        <h3 class="mt8">Run status</h3>
        <div id="run-status" class="muted">—</div>
        <div class="progress"><div id="run-bar" class="bar"></div></div>
      </div>
    </aside>
  </div>

  <!-- Bulk logic -->
  <script type="module" src="assets/js/bulk.js"></script>
</body>
</html>
